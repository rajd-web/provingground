<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Weather & Proving Ground – Slagnäs</title>

<style>
:root{
  --pad:24px;
  --card:rgba(0,0,0,.62);
  --radius:16px;
  --leftW:60vw;
  --rightW:40vw;
}

html,body{
  height:100%;
  margin:0;
  background:#000;
  overflow:hidden;
  font-family:system-ui,Segoe UI,Roboto,Arial;
  color:#fff;
}

/* MAP */
#map{
  position:fixed;
  left:0; top:0;
  width:var(--leftW);
  height:100vh;
  border:0;
}

/* TOP TITLE */
#pageTitle{
  position:fixed;
  top:var(--pad);
  left:var(--pad);
  background:var(--card);
  padding:14px 28px;
  border-radius:18px;
  font-size:38px;
  font-weight:800;
  z-index:30;
  backdrop-filter:blur(6px);
}

/* WEATHER HUD */
#hud{
  position:fixed;
  top:96px;
  left:var(--pad);
  width:min(720px, calc(var(--leftW) - var(--pad)*2));
  background:var(--card);
  padding:18px 22px;
  border-radius:var(--radius);
  backdrop-filter:blur(6px);
}

#rowTop{
  display:flex;
  justify-content:space-between;
}
#place{font-size:30px;margin:0;}
#time{font-size:34px;font-weight:700;}
#date{font-size:18px;opacity:.9;}

#nowRow{
  display:flex;
  align-items:center;
  gap:18px;
  margin-top:14px;
}
#nowIcon svg{width:90px;height:90px;}
#nowTemp{font-size:104px;font-weight:800;}

#desc{font-size:22px;margin-top:6px;}
#updated{font-size:16px;opacity:.8;margin-top:4px;}

/* FORECAST BOXES */
#widgets{
  display:flex;
  gap:16px;
  margin-top:16px;
}
.box{
  background:rgba(255,255,255,.12);
  border-radius:14px;
  padding:16px;
  flex:1;
}
.label{font-size:18px;font-weight:700;}
.row{
  display:flex;
  align-items:center;
  gap:12px;
}
.row svg{width:56px;height:56px;}
.temp{font-size:38px;font-weight:800;}
.text{font-size:16px;opacity:.9;margin-top:6px;}

/* RIGHT PANE */
#rightPane{
  position:fixed;
  right:0; top:0;
  width:var(--rightW);
  height:100vh;
  padding:var(--pad);
}

.card{
  background:var(--card);
  border-radius:var(--radius);
  padding:16px;
  backdrop-filter:blur(6px);
}

#trackHeader{
  font-size:26px;
  font-weight:800;
  margin-bottom:12px;
}

#trackFrameWrap{
  position:relative;
  height:calc(100vh - 180px);
  overflow:hidden;
}

#trackFrame{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  border:0;
  background:#111;
}

#fallback{
  font-size:14px;
  opacity:.85;
  margin-top:10px;
}
#fallback a{color:#fff;}
</style>
</head>

<body>

<!-- MAP -->
<iframe id="map"
src="https://www.openstreetmap.org/export/embed.html?bbox=20.956485271453857,64.73460494231747,20.978586673736576,64.73987965842787&layer=mapnik&marker=64.73724,20.96754">
</iframe>

<!-- TITLE -->
<div id="pageTitle">Weather forecast</div>

<!-- WEATHER -->
<section id="hud">
  <div id="rowTop">
    <h1 id="place">Slagnäs</h1>
    <div>
      <div id="time">--:--</div>
      <div id="date">----</div>
    </div>
  </div>

  <div id="nowRow">
    <div id="nowIcon"></div>
    <div id="nowTemp">--°C</div>
  </div>

  <div id="desc">Loading weather…</div>
  <div id="updated"></div>

  <div id="widgets">
    <div class="box">
      <div class="label">Now</div>
      <div class="row">
        <div id="iNow"></div>
        <div id="tNow" class="temp"></div>
      </div>
      <div id="dNow" class="text"></div>
    </div>

    <div class="box">
      <div class="label">In 3 hours</div>
      <div class="row">
        <div id="i3"></div>
        <div id="t3" class="temp"></div>
      </div>
      <div id="d3" class="text"></div>
    </div>

    <div class="box">
      <div class="label">Tomorrow</div>
      <div class="row">
        <div id="iT"></div>
        <div id="tT" class="temp"></div>
      </div>
      <div id="dT" class="text"></div>
    </div>
  </div>
</section>

<!-- TRACK STATUS -->
<aside id="rightPane">
  <div class="card">
    <div id="trackHeader">Proving Ground status</div>
<div id="trackFrameWrap">
  <div id="trackPlaceholder">
    <div id="trackMsgTitle">Login required</div>
    <div id="trackMsgText">
      The embedded view can’t use your session in this browser view.
      Open the status page in a new tab.
    </div>
    <a id="trackBigButton" href="#" target="_blank" rel="noopener">
      Open Proving Ground status
    </a>
  </div>
</div>
    <div id="fallback">
      If not visible:
      <a id="trackLink" target="_blank">Open Proving Ground status</a>
    </div>
  </div>
</aside>

<script>
/* SETTINGS */
const LAT=64.73724, LON=20.96754;
const TRACK_URL="https://test01.rajdsystech.com/resources?id=20,21,22,23,24,25,26,27&title=Proving%20Ground";
const SMHI_URL=`https://opendata-download-metfcst.smhi.se/api/category/pmp3g/version/2/geotype/point/lon/${LON}/lat/${LAT}/data.json`;

/* INIT TRACK */
trackFrame.src=TRACK_URL;
trackLink.href=TRACK_URL;

/* CLOCK */
function clock(){
  const n=new Date();
  time.textContent=n.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});
  date.textContent=n.toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"});
}

/* ICON */
function icon(){
  return `<svg viewBox="0 0 64 64" fill="white"><circle cx="32" cy="32" r="14"/></svg>`;
}

/* WEATHER */
async function load(){
  const d=await fetch(SMHI_URL).then(r=>r.json());
  const ts=d.timeSeries;
  const cur=ts[0];
  const t=cur.parameters.find(p=>p.name==="t").values[0];
  nowIcon.innerHTML=icon();
  nowTemp.textContent=Math.round(t)+"°C";
  desc.textContent="SMHI forecast";
  updated.textContent="Updated: "+new Date(cur.validTime).toLocaleTimeString("en-GB");

  tNow.textContent=Math.round(t)+"°C";
  dNow.textContent="Now";

  t3.textContent=Math.round(ts[3].parameters.find(p=>p.name==="t").values[0])+"°C";
  d3.textContent="In 3 hours";

  tT.textContent=Math.round(ts[24].parameters.find(p=>p.name==="t").values[0])+"°C";
  dT.textContent="Tomorrow";
}

clock(); setInterval(clock,1000);
load(); setInterval(load,600000);
</script>

</body>
</html>

